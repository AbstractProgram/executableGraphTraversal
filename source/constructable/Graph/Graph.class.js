"use strict";var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports, "__esModule", { value: true });exports.initialEntityPrototype = exports.Prototype = exports.Reference = exports.Graph = void 0;var _entity = require("@dependency/entity");
var _TraversalClass = require("../Traversal.class.js");
var _DatabaseClass = require("../Database.class.js");
var _ContextClass = require("../Context.class.js");
var _ImplementationManagementClass = require("../ImplementationManagement.class.js");
var entityPrototype = _interopRequireWildcard(require("./prototype.js"));
var implementation = _interopRequireWildcard(require("@dependency/graphTraversal-implementation"));
var schemeReference = _interopRequireWildcard(require("../../graphModel/graphSchemeReference.js"));












const { class: Graph, reference: Reference, constructablePrototype: Prototype, entityPrototype: initialEntityPrototype } = new _entity.Entity.clientInterface({ description: 'Graph' });exports.initialEntityPrototype = initialEntityPrototype;exports.Prototype = Prototype;exports.Reference = Reference;exports.Graph = Graph;

Object.assign(Reference, {
  key: {
    constructor: Symbol('Graph:key.constructor') } });











Object.assign(initialEntityPrototype, entityPrototype);








Prototype[_entity.Constructable.reference.initialize.functionality].setter.call(Prototype, {
  [_entity.Entity.reference.key.concereteBehavior]({ targetInstance, concereteBehaviorList } = {}, previousResult) {} });









Prototype[_entity.Constructable.reference.constructor.functionality].setter.call(Prototype, {







  [Reference.key.constructor]({


    database,
    traversal,

    concreteBehaviorList = [],
    data,
    callerClass = this,
    mode = 'applicationInMemory' || 'databaseInMemory' })





  {
    database || (database = new _DatabaseClass.Database.clientInterface({
      implementationList: {
        boltCypher: implementation.database.boltCypherModelAdapterFunction({ schemeReference }) },

      defaultImplementation: 'boltCypher' }));

    traversal || (traversal = new _TraversalClass.Traversal.clientInterface({
      implementationList: {
        default: {
          traverseNode: implementation.traversal.traverseNode,
          handlePropagation: implementation.traversal.handlePropagation,
          traversalInterception: implementation.traversal.traversalInterception,
          aggregator: implementation.traversal.aggregator,
          processData: implementation.traversal.processData } },


      defaultImplementation: 'default' }));




    let instance = _entity.Constructable[_entity.Constructable.reference.constructor.functionality].switch.call(callerClass, { implementationKey: _entity.Entity.reference.key.concereteBehavior })({
      concreteBehaviorList: [...concreteBehaviorList, database, traversal],
      data });


    let concereteDatabase = instance[_entity.Entity.reference.getInstanceOf](_DatabaseClass.Database);
    instance.database = concereteDatabase[_DatabaseClass.Database.reference.key.getter]();
    let concreteTraversal = instance[_entity.Entity.reference.getInstanceOf](_TraversalClass.Traversal);
    instance.traversal = concreteTraversal[_ImplementationManagementClass.ImplementationManagement.reference.key.getter]();
    let context = instance[_entity.Entity.reference.getInstanceOf](_ContextClass.Context);
    instance.context = context ? context[_ContextClass.Context.reference.key.getter]() : {};





    return instance;
  } });









Graph.clientInterface = Prototype[_entity.Constructable.reference.clientInterface.functionality].switch.call(Graph, {
  implementationKey: _entity.Entity.reference.key.instanceDelegatingToEntityInstancePrototype })(
{
  constructorImplementation: Reference.key.constructor,
  clientInterfaceInterceptCallback: false });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NvdXJjZS9jb25zdHJ1Y3RhYmxlL0dyYXBoL0dyYXBoLmNsYXNzLmpzIl0sIm5hbWVzIjpbImNsYXNzIiwiR3JhcGgiLCJyZWZlcmVuY2UiLCJSZWZlcmVuY2UiLCJjb25zdHJ1Y3RhYmxlUHJvdG90eXBlIiwiUHJvdG90eXBlIiwiZW50aXR5UHJvdG90eXBlIiwiaW5pdGlhbEVudGl0eVByb3RvdHlwZSIsIkVudGl0eSIsImNsaWVudEludGVyZmFjZSIsImRlc2NyaXB0aW9uIiwiT2JqZWN0IiwiYXNzaWduIiwia2V5IiwiY29uc3RydWN0b3IiLCJTeW1ib2wiLCJDb25zdHJ1Y3RhYmxlIiwiaW5pdGlhbGl6ZSIsImZ1bmN0aW9uYWxpdHkiLCJzZXR0ZXIiLCJjb25jZXJldGVCZWhhdmlvciIsInRhcmdldEluc3RhbmNlIiwiY29uY2VyZXRlQmVoYXZpb3JMaXN0IiwicHJldmlvdXNSZXN1bHQiLCJkYXRhYmFzZSIsInRyYXZlcnNhbCIsImNvbmNyZXRlQmVoYXZpb3JMaXN0IiwiZGF0YSIsImNhbGxlckNsYXNzIiwibW9kZSIsIkRhdGFiYXNlIiwiaW1wbGVtZW50YXRpb25MaXN0IiwiYm9sdEN5cGhlciIsImltcGxlbWVudGF0aW9uIiwiYm9sdEN5cGhlck1vZGVsQWRhcHRlckZ1bmN0aW9uIiwic2NoZW1lUmVmZXJlbmNlIiwiZGVmYXVsdEltcGxlbWVudGF0aW9uIiwiVHJhdmVyc2FsIiwiZGVmYXVsdCIsInRyYXZlcnNlTm9kZSIsImhhbmRsZVByb3BhZ2F0aW9uIiwidHJhdmVyc2FsSW50ZXJjZXB0aW9uIiwiYWdncmVnYXRvciIsInByb2Nlc3NEYXRhIiwiaW5zdGFuY2UiLCJzd2l0Y2giLCJpbXBsZW1lbnRhdGlvbktleSIsImNvbmNlcmV0ZURhdGFiYXNlIiwiZ2V0SW5zdGFuY2VPZiIsImdldHRlciIsImNvbmNyZXRlVHJhdmVyc2FsIiwiSW1wbGVtZW50YXRpb25NYW5hZ2VtZW50IiwiY29udGV4dCIsIkNvbnRleHQiLCJpbnN0YW5jZURlbGVnYXRpbmdUb0VudGl0eUluc3RhbmNlUHJvdG90eXBlIiwiY29uc3RydWN0b3JJbXBsZW1lbnRhdGlvbiIsImNsaWVudEludGVyZmFjZUludGVyY2VwdENhbGxiYWNrIl0sIm1hcHBpbmdzIjoia1FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQWFPLE1BQU0sRUFBRUEsS0FBSyxFQUFFQyxLQUFULEVBQWdCQyxTQUFTLEVBQUVDLFNBQTNCLEVBQXNDQyxzQkFBc0IsRUFBRUMsU0FBOUQsRUFBeUVDLGVBQWUsRUFBRUMsc0JBQTFGLEtBQXFILElBQUlDLGVBQU9DLGVBQVgsQ0FBMkIsRUFBRUMsV0FBVyxFQUFFLE9BQWYsRUFBM0IsQ0FBM0gsQzs7QUFFUEMsTUFBTSxDQUFDQyxNQUFQLENBQWNULFNBQWQsRUFBeUI7QUFDdkJVLEVBQUFBLEdBQUcsRUFBRTtBQUNIQyxJQUFBQSxXQUFXLEVBQUVDLE1BQU0sQ0FBQyx1QkFBRCxDQURoQixFQURrQixFQUF6Qjs7Ozs7Ozs7Ozs7O0FBY0FKLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjTCxzQkFBZCxFQUFzQ0QsZUFBdEM7Ozs7Ozs7OztBQVNXRCxTQUFTLENBQUNXLHNCQUFjZCxTQUFkLENBQXdCZSxVQUF4QixDQUFtQ0MsYUFBcEMsQ0FBVCxDQUE0REMsTUFBdkUsTUFBQWQsU0FBUyxFQUFxRTtBQUM1RSxHQUFDRyxlQUFPTixTQUFQLENBQWlCVyxHQUFqQixDQUFxQk8saUJBQXRCLEVBQXlDLEVBQUVDLGNBQUYsRUFBa0JDLHFCQUFsQixLQUE0QyxFQUFyRixFQUF5RkMsY0FBekYsRUFBeUcsQ0FBRSxDQUQvQixFQUFyRSxDQUFUOzs7Ozs7Ozs7O0FBV1dsQixTQUFTLENBQUNXLHNCQUFjZCxTQUFkLENBQXdCWSxXQUF4QixDQUFvQ0ksYUFBckMsQ0FBVCxDQUE2REMsTUFBeEUsTUFBQWQsU0FBUyxFQUFzRTs7Ozs7Ozs7QUFRN0UsR0FBQ0YsU0FBUyxDQUFDVSxHQUFWLENBQWNDLFdB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LHNCQUFjZCxTQUFkLENBQXdCTyxlQUF4QixDQUF3Q1MsYUFBekMsQ0FBVCxDQUFpRTJCLE1BQXhFLE1BQUE1QyxLQUFLLEVBQTBFO0FBQ3JHNkMsRUFBQUEsaUJBQWlCLEVBQUV0QyxlQUFPTixTQUFQLENBQWlCVyxHQUFqQixDQUFxQnlDLDJDQUQ2RCxFQUExRSxDQUFMO0FBRXJCO0FBQ0RDLEVBQUFBLHlCQUF5QixFQUFFcEQsU0FBUyxDQUFDVSxHQUFWLENBQWNDLFdBRHhDO0FBRUQwQyxFQUFBQSxnQ0FBZ0MsRUFBRSxLQUZqQyxFQUZxQixDQUF4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVudGl0eSwgQ29uc3RydWN0YWJsZSwgc3ltYm9sIH0gZnJvbSAnQGRlcGVuZGVuY3kvZW50aXR5J1xuaW1wb3J0IHsgVHJhdmVyc2FsIH0gZnJvbSAnLi4vVHJhdmVyc2FsLmNsYXNzLmpzJ1xuaW1wb3J0IHsgRGF0YWJhc2UgfSBmcm9tICcuLi9EYXRhYmFzZS5jbGFzcy5qcydcbmltcG9ydCB7IENvbnRleHQgfSBmcm9tICcuLi9Db250ZXh0LmNsYXNzLmpzJ1xuaW1wb3J0IHsgSW1wbGVtZW50YXRpb25NYW5hZ2VtZW50IH0gZnJvbSAnLi4vSW1wbGVtZW50YXRpb25NYW5hZ2VtZW50LmNsYXNzLmpzJ1xuaW1wb3J0ICogYXMgZW50aXR5UHJvdG90eXBlIGZyb20gJy4vcHJvdG90eXBlLmpzJ1xuaW1wb3J0ICogYXMgaW1wbGVtZW50YXRpb24gZnJvbSAnQGRlcGVuZGVuY3kvZ3JhcGhUcmF2ZXJzYWwtaW1wbGVtZW50YXRpb24nXG5pbXBvcnQgKiBhcyBzY2hlbWVSZWZlcmVuY2UgZnJvbSAnLi4vLi4vZ3JhcGhNb2RlbC9ncmFwaFNjaGVtZVJlZmVyZW5jZS5qcydcbi8vIGltcG9ydCB7IE5vZGUgfSBmcm9tICcuL05vZGUuY2xhc3MuanMnXG4vLyBpbXBvcnQgeyBDb25uZWN0aW9uIH0gZnJvbSAnLi4vQ29ubmVjdGlvbi5jbGFzcy5qcydcbi8vIGltcG9ydCB7IENhY2hlIH0gZnJvbSAnLi4vQ2FjaGUuY2xhc3MuanMnXG5cbi8qKiBDb25jZXB0dWFsIEdyYXBoXG4gKiBHcmFwaCBDbGFzcyBob2xkcyBhbmQgbWFuYWdlcyBncmFwaCBlbGVtZW50cyBhbmQgdHJhdmVyc2FsIGFsZ29yaXRobSBpbXBsZW1lbnRhdGlvbnM6XG4gKiAgLSBDYWNoZTogb24tZGVtYW5kIHJldHJpdmVkIG5vZGVzIGZyb20gREIgYXJlIGNhY2hlZC5cbiAqICAtIERhdGFiYXNlOiBnZXQgZ3JhcGggZGF0YSBhbmQgbG9hZCBpdCBpbnRvIG1lbW9yeS5cbiAqICAtIFRyYXZlcnNhbDogaW1wbGVtZW50YXRpb24gZm9yIHRoZSB0cmF2ZXJzYWwgYWxnb3JpdGhtLlxuICogIC0gQ29udGV4dDogc2hhcmVkIGRhdGEgYWNjZXNzaWJsZSBiZXR3ZWVuIHRyYXZlcnNhbHMuXG4gKiBUaGUgR3JhcGggaW5zdGFuY2Ugc2hvdWxkIGhhdmUgYW4gYWJpbGl0eSB0byBzZXQvY2hhbmdlIHN0cmF0ZWdpZXMvaW1wbGVtZW50YXRpb25zIG9uIHJ1bnRpbWUgYW5kIGFiaWxpdHkgdG8gdXNlIG11bHRpcGxlIHJlZ2lzdGVyZWQgaW1wbGVtZW50YXRpb25zLlxuICovXG5leHBvcnQgY29uc3QgeyBjbGFzczogR3JhcGgsIHJlZmVyZW5jZTogUmVmZXJlbmNlLCBjb25zdHJ1Y3RhYmxlUHJvdG90eXBlOiBQcm90b3R5cGUsIGVudGl0eVByb3RvdHlwZTogaW5pdGlhbEVudGl0eVByb3RvdHlwZSB9ID0gbmV3IEVudGl0eS5jbGllbnRJbnRlcmZhY2UoeyBkZXNjcmlwdGlvbjogJ0dyYXBoJyB9KVxuXG5PYmplY3QuYXNzaWduKFJlZmVyZW5jZSwge1xuICBrZXk6IHtcbiAgICBjb25zdHJ1Y3RvcjogU3ltYm9sKCdHcmFwaDprZXkuY29uc3RydWN0b3InKSxcbiAgfSxcbn0pXG5cbi8qXG4gICAgICAgICAgICAgICAgICAgXyAgICAgICAgXyAgICAgICAgICAgICAgICAgICAgX19fXyAgICAgICBfICAgICAgICAgICAgICAgICAgXyAgIF8gICAgICAgICAgICAgXG4gICBfIF9fICBfIF9fIF9fXyB8IHxfIF9fXyB8IHxfIF8gICBfIF8gX18gICBfX198ICBfIFxcICBfX198IHwgX19fICBfXyBfICBfXyBffCB8XyhfKSBfX18gIF8gX18gIFxuICB8ICdfIFxcfCAnX18vIF8gXFx8IF9fLyBfIFxcfCBfX3wgfCB8IHwgJ18gXFwgLyBfIFxcIHwgfCB8LyBfIFxcIHwvIF8gXFwvIF9gIHwvIF9gIHwgX198IHwvIF8gXFx8ICdfIFxcIFxuICB8IHxfKSB8IHwgfCAoXykgfCB8fCAoXykgfCB8X3wgfF98IHwgfF8pIHwgIF9fLyB8X3wgfCAgX18vIHwgIF9fLyAoX3wgfCAoX3wgfCB8X3wgfCAoXykgfCB8IHwgfFxuICB8IC5fXy98X3wgIFxcX19fLyBcXF9fXFxfX18vIFxcX198XFxfXywgfCAuX18vIFxcX19ffF9fX18vIFxcX19ffF98XFxfX198XFxfXywgfFxcX18sX3xcXF9ffF98XFxfX18vfF98IHxffFxuICB8X3wgICAgICAgICAgICAgICAgICAgICAgICAgICB8X19fL3xffCAgICAgICAgICAgICAgICAgICAgICAgICAgIHxfX18vICAgICAgICAgICAgICAgICAgICAgICAgIFxuKi9cbk9iamVjdC5hc3NpZ24oaW5pdGlhbEVudGl0eVByb3RvdHlwZSwgZW50aXR5UHJvdG90eXBlKVxuXG4vKlxuICAgXyAgICAgICBfIF8gICBfICAgICAgIF8gXyAgICAgICAgIFxuICAoXylfIF9fIChfKSB8XyhfKSBfXyBffCAoXylfX19fX19fIFxuICB8IHwgJ18gXFx8IHwgX198IHwvIF9gIHwgfCB8XyAgLyBfIFxcXG4gIHwgfCB8IHwgfCB8IHxffCB8IChffCB8IHwgfC8gLyAgX18vXG4gIHxffF98IHxffF98XFxfX3xffFxcX18sX3xffF8vX19fXFxfX198XG4qL1xuUHJvdG90eXBlOjpQcm90b3R5cGVbQ29uc3RydWN0YWJsZS5yZWZlcmVuY2UuaW5pdGlhbGl6ZS5mdW5jdGlvbmFsaXR5XS5zZXR0ZXIoe1xuICBbRW50aXR5LnJlZmVyZW5jZS5rZXkuY29uY2VyZXRlQmVoYXZpb3JdKHsgdGFyZ2V0SW5zdGFuY2UsIGNvbmNlcmV0ZUJlaGF2aW9yTGlzdCB9ID0ge30sIHByZXZpb3VzUmVzdWx0KSB7fSxcbn0pXG5cbi8qXG4gICAgICAgICAgICAgICAgICAgICAgIF8gICAgICAgICAgICAgICAgICAgXyAgICAgICAgICAgICBcbiAgICBfX18gX19fICBfIF9fICBfX198IHxfIF8gX18gXyAgIF8gIF9fX3wgfF8gX19fICBfIF9fIFxuICAgLyBfXy8gXyBcXHwgJ18gXFwvIF9ffCBfX3wgJ19ffCB8IHwgfC8gX198IF9fLyBfIFxcfCAnX198XG4gIHwgKF98IChfKSB8IHwgfCBcXF9fIFxcIHxffCB8ICB8IHxffCB8IChfX3wgfHwgKF8pIHwgfCAgIFxuICAgXFxfX19cXF9fXy98X3wgfF98X19fL1xcX198X3wgICBcXF9fLF98XFxfX198XFxfX1xcX19fL3xffCAgIFxuKi9cblByb3RvdHlwZTo6UHJvdG90eXBlW0NvbnN0cnVjdGFibGUucmVmZXJlbmNlLmNvbnN0cnVjdG9yLmZ1bmN0aW9uYWxpdHldLnNldHRlcih7XG4gIC8qKlxuICAgKiBHcmFwaCB3aWxsIGNvbnRhaW4gdGhlIHByb3RvdHlwZSBjaGFpbiB0byBpbnN0YWxsIG9uIHRoZSBpbnN0YW5jZXMgKHByZXZpb3VzbHkgJ2NsYXNzZXMgaGllcmFyY2h5IGNvbm5lY3Rpb25zYClcbiAgICogMS4gY29uZmlndXJlZENvbnN0cnVjdGFibGUxID0gR3JhcGgoPHBsdWdpbnM+KVxuICAgKiAyLiBjb25maWd1cmVkQ29uc3RydWN0YWJsZTIgPSBjb25maWd1cmVkQ29uc3RydWN0YWJsZTEoPGNvbnRleHQ+KVxuICAgKiAzLiBuZXcgY29uZmlndXJlZENvbnN0cnVjdGFibGUyKDxpbnN0YW5jZSBkYXRhPikgLy8gY3JlYXRlcyBpbnN0YW5jZVxuICAgKiA0LiB0cmF2ZXJzZSBncmFwaDogZS5nLiBpbnN0YW5jZS50cmF2ZXJzZUdyYXBoKClcbiAgICovXG4gIFtSZWZlcmVuY2Uua2V5LmNvbnN0cnVjdG9yXSh7XG4gICAgLy8gQ29uY2VyZXRlIGJlaGF2aW9ycyAvIGltcGxlbWVudGFpb25zXG4gICAgLy8gY2FjaGUsXG4gICAgZGF0YWJhc2UsIC8vIGRhdGFiYXNlIGNvbmNyZXRlIGJlaGF2aW9yXG4gICAgdHJhdmVyc2FsLCAvLyB0cmF2ZXJzYWwgY29uY3JldGUgYmVoYXZpb3JcbiAgICAvLyBhZGRpdGlvbmFsIGJlaGF2aW9yc1xuICAgIGNvbmNyZXRlQmVoYXZpb3JMaXN0ID0gW10sXG4gICAgZGF0YSwgLy8gZGF0YSB0byBiZSBtZXJnZWQgaW50byB0aGUgaW5zdGFuY2VcbiAgICBjYWxsZXJDbGFzcyA9IHRoaXMsXG4gICAgbW9kZSA9ICdhcHBsaWNhdGlvbkluTWVtb3J5JyB8fCAnZGF0YWJhc2VJbk1lbW9yeScsXG4gIH06IHtcbiAgICBjYWNoZTogQ2FjaGUsXG4gICAgZGF0YWJhc2U6IERhdGFiYXNlLFxuICAgIHRyYXZlcnNhbDogVHJhdmVyc2FsLFxuICAgIGNvbmNlcmV0ZUJlaGF2aW9yOiBMaXN0LFxuICB9KSB7XG4gICAgZGF0YWJhc2UgfHw9IG5ldyBEYXRhYmFzZS5jbGllbnRJbnRlcmZhY2Uoe1xuICAgICAgaW1wbGVtZW50YXRpb25MaXN0OiB7XG4gICAgICAgIGJvbHRDeXBoZXI6IGltcGxlbWVudGF0aW9uLmRhdGFiYXNlLmJvbHRDeXBoZXJNb2RlbEFkYXB0ZXJGdW5jdGlvbih7IHNjaGVtZVJlZmVyZW5jZSB9KSxcbiAgICAgIH0sXG4gICAgICBkZWZhdWx0SW1wbGVtZW50YXRpb246ICdib2x0Q3lwaGVyJyxcbiAgICB9KVxuICAgIHRyYXZlcnNhbCB8fD0gbmV3IFRyYXZlcnNhbC5jbGllbnRJbnRlcmZhY2Uoe1xuICAgICAgaW1wbGVtZW50YXRpb25MaXN0OiB7XG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICB0cmF2ZXJzZU5vZGU6IGltcGxlbWVudGF0aW9uLnRyYXZlcnNhbC50cmF2ZXJzZU5vZGUsXG4gICAgICAgICAgaGFuZGxlUHJvcGFnYXRpb246IGltcGxlbWVudGF0aW9uLnRyYXZlcnNhbC5oYW5kbGVQcm9wYWdhdGlvbiwgLy8gUG9ydFxuICAgICAgICAgIHRyYXZlcnNhbEludGVyY2VwdGlvbjogaW1wbGVtZW50YXRpb24udHJhdmVyc2FsLnRyYXZlcnNhbEludGVyY2VwdGlvbiwgLy8gU3RhZ2VcbiAgICAgICAgICBhZ2dyZWdhdG9yOiBpbXBsZW1lbnRhdGlvbi50cmF2ZXJzYWwuYWdncmVnYXRvcixcbiAgICAgICAgICBwcm9jZXNzRGF0YTogaW1wbGVtZW50YXRpb24udHJhdmVyc2FsLnByb2Nlc3NEYXRhLCAvLyBQcm9jZXNzXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgZGVmYXVsdEltcGxlbWVudGF0aW9uOiAnZGVmYXVsdCcsXG4gICAgfSlcblxuICAgIC8vIGNhY2hlIHx8PSBuZXcgQ2FjaGUuY2xpZW50SW50ZXJmYWNlKHsgZ3JvdXBLZXlBcnJheTogWydub2RlJywgJ2Nvbm5lY3Rpb24nXSB9KVxuXG4gICAgbGV0IGluc3RhbmNlID0gY2FsbGVyQ2xhc3M6OkNvbnN0cnVjdGFibGVbQ29uc3RydWN0YWJsZS5yZWZlcmVuY2UuY29uc3RydWN0b3IuZnVuY3Rpb25hbGl0eV0uc3dpdGNoKHsgaW1wbGVtZW50YXRpb25LZXk6IEVudGl0eS5yZWZlcmVuY2Uua2V5LmNvbmNlcmV0ZUJlaGF2aW9yIH0pKHtcbiAgICAgIGNvbmNyZXRlQmVoYXZpb3JMaXN0OiBbLi4uY29uY3JldGVCZWhhdmlvckxpc3QsIC8qY2FjaGUsKi8gZGF0YWJhc2UsIHRyYXZlcnNhbF0sXG4gICAgICBkYXRhLFxuICAgIH0pXG4gICAgLy8gZXhwb3NlIGZ1bmN0aW9uYWxpdHkgZm9yIGRpcmVjdCBzaW1wbGlmaWVkIGFjY2VzczpcbiAgICBsZXQgY29uY2VyZXRlRGF0YWJhc2UgPSBpbnN0YW5jZVtFbnRpdHkucmVmZXJlbmNlLmdldEluc3RhbmNlT2ZdKERhdGFiYXNlKVxuICAgIGluc3RhbmNlLmRhdGFiYXNlID0gY29uY2VyZXRlRGF0YWJhc2VbRGF0YWJhc2UucmVmZXJlbmNlLmtleS5nZXR0ZXJdKClcbiAgICBsZXQgY29uY3JldGVUcmF2ZXJzYWwgPSBpbnN0YW5jZVtFbnRpdHkucmVmZXJlbmNlLmdldEluc3RhbmNlT2ZdKFRyYXZlcnNhbClcbiAgICBpbnN0YW5jZS50cmF2ZXJzYWwgPSBjb25jcmV0ZVRyYXZlcnNhbFtJbXBsZW1lbnRhdGlvbk1hbmFnZW1lbnQucmVmZXJlbmNlLmtleS5nZXR0ZXJdKClcbiAgICBsZXQgY29udGV4dCA9IGluc3RhbmNlW0VudGl0eS5yZWZlcmVuY2UuZ2V0SW5zdGFuY2VPZl0oQ29udGV4dClcbiAgICBpbnN0YW5jZS5jb250ZXh0ID0gY29udGV4dCA/IGNvbnRleHRbQ29udGV4dC5yZWZlcmVuY2Uua2V5LmdldHRlcl0oKSA6IHt9XG5cbiAgICAvLyBjb25maWd1cmUgR3JhcGggZWxlbWVudCBjbGFzc2VzXG4gICAgLy8gaW5zdGFuY2UuY29uZmlndXJlZE5vZGUgPSBOb2RlLmNsaWVudEludGVyZmFjZSh7IHBhcmFtZXRlcjogW3sgY29uY3JldGVCZWhhdmlvckxpc3Q6IFtdIH1dIH0pXG4gICAgLy8gaW5zdGFuY2UuY29uZmlndXJlZENvbm5lY3Rpb24gPSBDb25uZWN0aW9uLmNsaWVudEludGVyZmFjZSh7IHBhcmFtZXRlcjogW3sgY29uY2VyZXRlQmVoYXZpb3I6IFtdIH1dIH0pXG5cbiAgICByZXR1cm4gaW5zdGFuY2VcbiAgfSxcbn0pXG5cbi8qXG4gICAgICAgIF8gXyAgICAgICAgICAgIF8gICBfX18gICAgICAgXyAgICAgICAgICAgICBfXyAgICAgICAgICAgICAgICBcbiAgICBfX198IChfKSBfX18gXyBfXyB8IHxffF8gX3xfIF9fIHwgfF8gX19fIF8gX18gLyBffCBfXyBfICBfX18gX19fIFxuICAgLyBfX3wgfCB8LyBfIFxcICdfIFxcfCBfX3x8IHx8ICdfIFxcfCBfXy8gXyBcXCAnX198IHxfIC8gX2AgfC8gX18vIF8gXFxcbiAgfCAoX198IHwgfCAgX18vIHwgfCB8IHxfIHwgfHwgfCB8IHwgfHwgIF9fLyB8ICB8ICBffCAoX3wgfCAoX3wgIF9fL1xuICAgXFxfX198X3xffFxcX19ffF98IHxffFxcX198X19ffF98IHxffFxcX19cXF9fX3xffCAgfF98ICBcXF9fLF98XFxfX19cXF9fX3xcbiovXG5HcmFwaC5jbGllbnRJbnRlcmZhY2UgPSBHcmFwaDo6UHJvdG90eXBlW0NvbnN0cnVjdGFibGUucmVmZXJlbmNlLmNsaWVudEludGVyZmFjZS5mdW5jdGlvbmFsaXR5XS5zd2l0Y2goe1xuICBpbXBsZW1lbnRhdGlvbktleTogRW50aXR5LnJlZmVyZW5jZS5rZXkuaW5zdGFuY2VEZWxlZ2F0aW5nVG9FbnRpdHlJbnN0YW5jZVByb3RvdHlwZSxcbn0pKHtcbiAgY29uc3RydWN0b3JJbXBsZW1lbnRhdGlvbjogUmVmZXJlbmNlLmtleS5jb25zdHJ1Y3RvcixcbiAgY2xpZW50SW50ZXJmYWNlSW50ZXJjZXB0Q2FsbGJhY2s6IGZhbHNlLFxufSlcbiJdfQ==