"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.entityPrototype = exports.Prototype = exports.Reference = exports.Cache = void 0;
var _entity = require("@dependency/entity");
var _multiplePrototypeDelegation = require("@dependency/multiplePrototypeDelegation");




const { class: Cache, reference: Reference, constructablePrototype: Prototype, entityPrototype } = new _entity.Entity.clientInterface({ description: 'Cache' });exports.entityPrototype = entityPrototype;exports.Prototype = Prototype;exports.Reference = Reference;exports.Cache = Cache;

Object.assign(Reference, {
  key: {
    defaultGroupKey: Symbol('Cache defaultGroupKey'),
    list: Symbol('Cache list'),
    getter: Symbol('Cache getter'),
    setter: Symbol('Cache setter'),
    getLength: Symbol('Cache getLength of cached items'),
    initializeGroup: Symbol('Cache initializeGroup') } });











const defaultGroupKey = Reference.key.defaultGroupKey;
Object.assign(entityPrototype, {
  [_entity.Entity.reference.key.concereteBehavior]({ constructorCallback, currentConcereteBehavior }) {
    return new Proxy(constructorCallback, {
      apply(target, thisArg, argumentList) {
        const { data } = argumentList[0];
        let instance = Reflect.apply(...arguments);
        _multiplePrototypeDelegation.MultipleDelegation.addDelegation({ targetObject: instance, delegationList: [currentConcereteBehavior] });
        return instance;
      } });

  },
  [Reference.key.getter](key, groupKey = defaultGroupKey) {var _this$Reference$key$l;
    if (!key) return _this$Reference$key$l = this[Reference.key.list][groupKey], [..._this$Reference$key$l.values()];
    return this[Reference.key.list][groupKey].get(key) || undefined;
  },
  [Reference.key.setter](key, value, groupKey = defaultGroupKey) {
    if (key === undefined || key === null) throw new Error('â€¢ Invalid key argument.');
    this[Reference.key.list][groupKey].set(key, value);
  },
  [Reference.key.getLength](groupKey = defaultGroupKey) {
    return this[Reference.key.list][groupKey].size;
  },
  [Reference.key.initializeGroup](groupKey) {
    if (!this[Reference.key.list][groupKey]) this[Reference.key.list][groupKey] = new Map();
  } });









Cache[_entity.Constructable.reference.initialize.functionality].setter.call(Cache, {

  [_entity.Entity.reference.key.handleDataInstance]({ targetInstance, data }, previousResult) {
    let groupKeyArray = data.groupKeyArray || [];
    targetInstance[Reference.key.list] = {};
    for (let groupKey of groupKeyArray) {
      targetInstance[Reference.key.initializeGroup].call(targetInstance, groupKey);
    }
    targetInstance[Reference.key.initializeGroup].call(targetInstance, defaultGroupKey);
    return targetInstance;
  } });









Cache.clientInterface = Prototype[_entity.Constructable.reference.clientInterface.functionality].switch.call(Cache, {
  implementationKey: _entity.Entity.reference.key.instanceDelegatingToEntityInstancePrototype })(
{
  constructorImplementation: _entity.Entity.reference.key.handleDataInstance });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NvdXJjZS9jb25zdHJ1Y3RhYmxlL0NhY2hlLmNsYXNzLmpzIl0sIm5hbWVzIjpbImNsYXNzIiwiQ2FjaGUiLCJyZWZlcmVuY2UiLCJSZWZlcmVuY2UiLCJjb25zdHJ1Y3RhYmxlUHJvdG90eXBlIiwiUHJvdG90eXBlIiwiZW50aXR5UHJvdG90eXBlIiwiRW50aXR5IiwiY2xpZW50SW50ZXJmYWNlIiwiZGVzY3JpcHRpb24iLCJPYmplY3QiLCJhc3NpZ24iLCJrZXkiLCJkZWZhdWx0R3JvdXBLZXkiLCJTeW1ib2wiLCJsaXN0IiwiZ2V0dGVyIiwic2V0dGVyIiwiZ2V0TGVuZ3RoIiwiaW5pdGlhbGl6ZUdyb3VwIiwiY29uY2VyZXRlQmVoYXZpb3IiLCJjb25zdHJ1Y3RvckNhbGxiYWNrIiwiY3VycmVudENvbmNlcmV0ZUJlaGF2aW9yIiwiUHJveHkiLCJhcHBseSIsInRhcmdldCIsInRoaXNBcmciLCJhcmd1bWVudExpc3QiLCJkYXRhIiwiaW5zdGFuY2UiLCJSZWZsZWN0IiwiYXJndW1lbnRzIiwiTXVsdGlwbGVEZWxlZ2F0aW9uIiwiYWRkRGVsZWdhdGlvbiIsInRhcmdldE9iamVjdCIsImRlbGVnYXRpb25MaXN0IiwiZ3JvdXBLZXkiLCJtYXAiLCJ2YWx1ZXMiLCJnZXQiLCJ1bmRlZmluZWQiLCJ2YWx1ZSIsIkVycm9yIiwic2V0Iiwic2l6ZSIsIk1hcCIsIkNvbnN0cnVjdGFibGUiLCJpbml0aWFsaXplIiwiZnVuY3Rpb25hbGl0eSIsImhhbmRsZURhdGFJbnN0YW5jZSIsInRhcmdldEluc3RhbmNlIiwicHJldmlvdXNSZXN1bHQiLCJncm91cEtleUFycmF5Iiwic3dpdGNoIiwiaW1wbGVtZW50YXRpb25LZXkiLCJpbnN0YW5jZURlbGVnYXRpbmdUb0VudGl0eUluc3RhbmNlUHJvdG90eXBlIiwiY29uc3RydWN0b3JJbXBsZW1lbnRhdGlvbiJdLCJtYXBwaW5ncyI6IjtBQUNBO0FBQ0E7Ozs7O0FBS08sTUFBTSxFQUFFQSxLQUFLLEVB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eEIsQ0FBd0N3QyxhQUF6QyxDQUFULENBQWlFSyxNQUF4RSxNQUFBcEQsS0FBSyxFQUEwRTtBQUNyR3FELEVBQUFBLGlCQUFpQixFQUFFL0MsZUFBT0wsU0FBUCxDQUFpQlUsR0FBakIsQ0FBcUIyQywyQ0FENkQsRUFBMUUsQ0FBTDtBQUVyQjtBQUNEQyxFQUFBQSx5QkFBeUIsRUFBRWpELGVBQU9MLFNBQVAsQ0FBaUJVLEdBQWpCLENBQXFCcUMsa0JBRC9DLEVBRnFCLENBQXhCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFzc2VydCBmcm9tICdhc3NlcnQnXG5pbXBvcnQgeyBFbnRpdHksIENvbnN0cnVjdGFibGUsIHN5bWJvbCB9IGZyb20gJ0BkZXBlbmRlbmN5L2VudGl0eSdcbmltcG9ydCB7IE11bHRpcGxlRGVsZWdhdGlvbiB9IGZyb20gJ0BkZXBlbmRlbmN5L211bHRpcGxlUHJvdG90eXBlRGVsZWdhdGlvbidcblxuLyoqXG4gKiogQ2FjaGUgc3lzdGVtIGZvciBzdXBwb3J0aW5nIGRpZmZlcmVudCBncmFwaCBpbXBsZW1lbnRhdGlvbiBhbmQgZGF0YWJhc2UgYWRhcHRlcnMuXG4gKi9cbmV4cG9ydCBjb25zdCB7IGNsYXNzOiBDYWNoZSwgcmVmZXJlbmNlOiBSZWZlcmVuY2UsIGNvbnN0cnVjdGFibGVQcm90b3R5cGU6IFByb3RvdHlwZSwgZW50aXR5UHJvdG90eXBlIH0gPSBuZXcgRW50aXR5LmNsaWVudEludGVyZmFjZSh7IGRlc2NyaXB0aW9uOiAnQ2FjaGUnIH0pXG5cbk9iamVjdC5hc3NpZ24oUmVmZXJlbmNlLCB7XG4gIGtleToge1xuICAgIGRlZmF1bHRHcm91cEtleTogU3ltYm9sKCdDYWNoZSBkZWZhdWx0R3JvdXBLZXknKSxcbiAgICBsaXN0OiBTeW1ib2woJ0NhY2hlIGxpc3QnKSxcbiAgICBnZXR0ZXI6IFN5bWJvbCgnQ2FjaGUgZ2V0dGVyJyksXG4gICAgc2V0dGVyOiBTeW1ib2woJ0NhY2hlIHNldHRlcicpLFxuICAgIGdldExlbmd0aDogU3ltYm9sKCdDYWNoZSBnZXRMZW5ndGggb2YgY2FjaGVkIGl0ZW1zJyksXG4gICAgaW5pdGlhbGl6ZUdyb3VwOiBTeW1ib2woJ0NhY2hlIGluaXRpYWxpemVHcm91cCcpLCAvLyBjYWNoZSBncm91cFxuICB9LFxufSlcblxuLypcbiAgICAgICAgICAgICAgICAgICBfICAgICAgICBfICAgICAgICAgICAgICAgICAgICBfX19fICAgICAgIF8gICAgICAgICAgICAgICAgICBfICAgXyAgICAgICAgICAgICBcbiAgIF8gX18gIF8gX18gX19fIHwgfF8gX19fIHwgfF8gXyAgIF8gXyBfXyAgIF9fX3wgIF8gXFwgIF9fX3wgfCBfX18gIF9fIF8gIF9fIF98IHxfKF8pIF9fXyAgXyBfXyAgXG4gIHwgJ18gXFx8ICdfXy8gXyBcXHwgX18vIF8gXFx8IF9ffCB8IHwgfCAnXyBcXCAvIF8gXFwgfCB8IHwvIF8gXFwgfC8gXyBcXC8gX2AgfC8gX2AgfCBfX3wgfC8gXyBcXHwgJ18gXFwgXG4gIHwgfF8pIHwgfCB8IChfKSB8IHx8IChfKSB8IHxffCB8X3wgfCB8XykgfCAgX18vIHxffCB8ICBfXy8gfCAgX18vIChffCB8IChffCB8IHxffCB8IChfKSB8IHwgfCB8XG4gIHwgLl9fL3xffCAgXFxfX18vIFxcX19cXF9fXy8gXFxfX3xcXF9fLCB8IC5fXy8gXFxfX198X19fXy8gXFxfX198X3xcXF9fX3xcXF9fLCB8XFxfXyxffFxcX198X3xcXF9fXy98X3wgfF98XG4gIHxffCAgICAgICAgICAgICAgICAgICAgICAgICAgIHxfX18vfF98ICAgICAgICAgICAgICAgICAgICAgICAgICAgfF9fXy8gICAgICAgICAgICAgICAgICAgICAgICAgXG4qL1xuY29uc3QgZGVmYXVsdEdyb3VwS2V5ID0gUmVmZXJlbmNlLmtleS5kZWZhdWx0R3JvdXBLZXlcbk9iamVjdC5hc3NpZ24oZW50aXR5UHJvdG90eXBlLCB7XG4gIFtFbnRpdHkucmVmZXJlbmNlLmtleS5jb25jZXJldGVCZWhhdmlvcl0oeyBjb25zdHJ1Y3RvckNhbGxiYWNrLCBjdXJyZW50Q29uY2VyZXRlQmVoYXZpb3IgfSkge1xuICAgIHJldHVybiBuZXcgUHJveHkoY29uc3RydWN0b3JDYWxsYmFjaywge1xuICAgICAgYXBwbHkodGFyZ2V0LCB0aGlzQXJnLCBhcmd1bWVudExpc3QpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhcmd1bWVudExpc3RbMF1cbiAgICAgICAgbGV0IGluc3RhbmNlID0gUmVmbGVjdC5hcHBseSguLi5hcmd1bWVudHMpXG4gICAgICAgIE11bHRpcGxlRGVsZWdhdGlvbi5hZGREZWxlZ2F0aW9uKHsgdGFyZ2V0T2JqZWN0OiBpbnN0YW5jZSwgZGVsZWdhdGlvbkxpc3Q6IFtjdXJyZW50Q29uY2VyZXRlQmVoYXZpb3JdIH0pXG4gICAgICAgIHJldHVybiBpbnN0YW5jZVxuICAgICAgfSxcbiAgICB9KVxuICB9LFxuICBbUmVmZXJlbmNlLmtleS5nZXR0ZXJdKGtleSwgZ3JvdXBLZXkgPSBkZWZhdWx0R3JvdXBLZXkpIHtcbiAgICBpZiAoIWtleSkgcmV0dXJuIHRoaXNbUmVmZXJlbmNlLmtleS5saXN0XVtncm91cEtleV0gfD4gKG1hcCA9PiBbLi4ubWFwLnZhbHVlcygpXSkgLy8gcmV0cmlldmUgZW50aXJlIGxpc3QgZ3JvdXBcbiAgICByZXR1cm4gdGhpc1tSZWZlcmVuY2Uua2V5Lmxpc3RdW2dyb3VwS2V5XS5nZXQoa2V5KSB8fCB1bmRlZmluZWRcbiAgfSxcbiAgW1JlZmVyZW5jZS5rZXkuc2V0dGVyXShrZXksIHZhbHVlLCBncm91cEtleSA9IGRlZmF1bHRHcm91cEtleSkge1xuICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZCB8fCBrZXkgPT09IG51bGwpIHRocm93IG5ldyBFcnJvcign4oCiIEludmFsaWQga2V5IGFyZ3VtZW50LicpXG4gICAgdGhpc1tSZWZlcmVuY2Uua2V5Lmxpc3RdW2dyb3VwS2V5XS5zZXQoa2V5LCB2YWx1ZSlcbiAgfSxcbiAgW1JlZmVyZW5jZS5rZXkuZ2V0TGVuZ3RoXShncm91cEtleSA9IGRlZmF1bHRHcm91cEtleSkge1xuICAgIHJldHVybiB0aGlzW1JlZmVyZW5jZS5rZXkubGlzdF1bZ3JvdXBLZXldLnNpemVcbiAgfSxcbiAgW1JlZmVyZW5jZS5rZXkuaW5pdGlhbGl6ZUdyb3VwXShncm91cEtleSkge1xuICAgIGlmICghdGhpc1tSZWZlcmVuY2Uua2V5Lmxpc3RdW2dyb3VwS2V5XSkgdGhpc1tSZWZlcmVuY2Uua2V5Lmxpc3RdW2dyb3VwS2V5XSA9IG5ldyBNYXAoKSAvLyBpbml0aWFsaXplIGFuIGVtcHR5IGNhY2hlIGxpc3RcbiAgfSxcbn0pXG5cbi8qXG4gICBfX18gICAgICAgXyBfICAgXyAgICAgICBfIF8gICAgICAgICBcbiAgfF8gX3xfIF9fIChfKSB8XyhfKSBfXyBffCAoXylfX19fX19fIFxuICAgfCB8fCAnXyBcXHwgfCBfX3wgfC8gX2AgfCB8IHxfICAvIF8gXFxcbiAgIHwgfHwgfCB8IHwgfCB8X3wgfCAoX3wgfCB8IHwvIC8gIF9fL1xuICB8X19ffF98IHxffF98XFxfX3xffFxcX18sX3xffF8vX19fXFxfX198XG4qL1xuQ2FjaGU6OkNhY2hlW0NvbnN0cnVjdGFibGUucmVmZXJlbmNlLmluaXRpYWxpemUuZnVuY3Rpb25hbGl0eV0uc2V0dGVyKHtcbiAgLy8gaW5pdGlhbGl6YXRpb24gZm9yIGluc3RhbmNlIG9mIENhY2hlIC0gaS5lLiBhIGNvbmNyZXRlIGJlaGF2aW9yIG9mIENhY2hlIChhbiBpbXBsZW1lYW50YXRpb24pXG4gIFtFbnRpdHkucmVmZXJlbmNlLmtleS5oYW5kbGVEYXRhSW5zdGFuY2VdKHsgdGFyZ2V0SW5zdGFuY2UsIGRhdGEgfSwgcHJldmlvdXNSZXN1bHQgLyogaW4gY2FzZSBtdWx0aXBsZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiBmb3VuZCBhbmQgZXhlY3V0ZWQuICovKSB7XG4gICAgbGV0IGdyb3VwS2V5QXJyYXkgPSBkYXRhLmdyb3VwS2V5QXJyYXkgfHwgW11cbiAgICB0YXJnZXRJbnN0YW5jZVtSZWZlcmVuY2Uua2V5Lmxpc3RdID0ge30gLy8gaW5pdGlhbGl6ZSBsaXN0XG4gICAgZm9yIChsZXQgZ3JvdXBLZXkgb2YgZ3JvdXBLZXlBcnJheSkge1xuICAgICAgdGFyZ2V0SW5zdGFuY2U6OnRhcmdldEluc3RhbmNlW1JlZmVyZW5jZS5rZXkuaW5pdGlhbGl6ZUdyb3VwXShncm91cEtleSlcbiAgICB9XG4gICAgdGFyZ2V0SW5zdGFuY2U6OnRhcmdldEluc3RhbmNlW1JlZmVyZW5jZS5rZXkuaW5pdGlhbGl6ZUdyb3VwXShkZWZhdWx0R3JvdXBLZXkpIC8vIGluaXRpYWxpemUgZGVmYXVsdCBjYWNoZSBncm91cFxuICAgIHJldHVybiB0YXJnZXRJbnN0YW5jZVxuICB9LFxufSlcblxuLypcbiAgICBfX19fIF8gXyAgICAgICAgICAgIF8gICAgIF8gXyAgICAgICAgICAgICAgICAgICAgX18gICAgICAgICAgICAgICAgXG4gICAvIF9fX3wgKF8pIF9fXyBfIF9fIHwgfF8gIChfKSB8XyBfIF9fICAgX19fIF8gX18gLyBffCBfXyBfICBfX18gX19fIFxuICB8IHwgICB8IHwgfC8gXyBcXCAnXyBcXHwgX198IHwgfCBfX3wgJ18gXFwgLyBfIFxcICdfX3wgfF8gLyBfYCB8LyBfXy8gXyBcXFxuICB8IHxfX198IHwgfCAgX18vIHwgfCB8IHxfICB8IHwgfF98IHwgfCB8ICBfXy8gfCAgfCAgX3wgKF98IHwgKF98ICBfXy9cbiAgIFxcX19fX3xffF98XFxfX198X3wgfF98XFxfX3wgfF98XFxfX3xffCB8X3xcXF9fX3xffCAgfF98ICBcXF9fLF98XFxfX19cXF9fX3xcbiovXG5DYWNoZS5jbGllbnRJbnRlcmZhY2UgPSBDYWNoZTo6UHJvdG90eXBlW0NvbnN0cnVjdGFibGUucmVmZXJlbmNlLmNsaWVudEludGVyZmFjZS5mdW5jdGlvbmFsaXR5XS5zd2l0Y2goe1xuICBpbXBsZW1lbnRhdGlvbktleTogRW50aXR5LnJlZmVyZW5jZS5rZXkuaW5zdGFuY2VEZWxlZ2F0aW5nVG9FbnRpdHlJbnN0YW5jZVByb3RvdHlwZSxcbn0pKHtcbiAgY29uc3RydWN0b3JJbXBsZW1lbnRhdGlvbjogRW50aXR5LnJlZmVyZW5jZS5rZXkuaGFuZGxlRGF0YUluc3RhbmNlLFxufSlcbiJdfQ==